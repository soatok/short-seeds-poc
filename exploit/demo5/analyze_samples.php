<?php
/* This file is not part of the PoC, but is used to evaluate the advantage of the PoC over
 * linear search.
 */

if ($argc < 2) {
    die('Argument 1 is required (number)');
}
$number_samples = (int) $argv[1];

$data = [
    [
        'poc-steps',
        'poc-elapsed',
        'linear-steps',
        'linear-elapsed',
    ]
];
$pocSteps = 0;
$linearSteps = 0;
$pocElapsed = 0.00;
$linearElapsed = 0.00;
for ($sample = 0; $sample < $number_samples; ++$sample) {
    $poc = json_decode(file_get_contents(__DIR__ . '/samples/poc-' . $sample . '.json'), true);
    $linear = json_decode(file_get_contents(__DIR__ . '/samples/linear-' . $sample . '.json'), true);
    $data []= [
        $poc['steps'],
        $poc['elapsed'],
        $linear['steps'],
        $linear['elapsed'],
    ];
    $pocSteps += $poc['steps'];
    $linearSteps += $linear['steps'];
    $pocElapsed += $poc['elapsed'];
    $linearElapsed += $linear['elapsed'];
}

$avgPocSteps = $pocSteps / $number_samples;
$avgLinearSteps = $linearSteps / $number_samples;
$avgPocElapsed = $pocElapsed / $number_samples;
$avgLinearElapsed = $linearElapsed / $number_samples;

echo "Proof of Concept:" . PHP_EOL;
echo "\tAvg. Steps: ${avgPocSteps}" . PHP_EOL;
echo "\tAvg. Time: ${avgPocElapsed}" . PHP_EOL;
echo PHP_EOL;

echo "Linear Search:" . PHP_EOL;
echo "\tAvg. Steps: ${avgLinearSteps}" . PHP_EOL;
echo "\tAvg. Time: ${avgLinearElapsed}" . PHP_EOL;
echo PHP_EOL;

$fp = fopen(__DIR__. '/samples/results.csv','w+');
foreach ($data as $row) {
    fputcsv($fp, $row);
}
fclose($fp);

echo __DIR__. '/sample/results.csv', PHP_EOL;
