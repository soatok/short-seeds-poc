<?php
declare(strict_types=1);
require_once dirname( __DIR__) . '/bootstrap.php';

$start = $stop = microtime(true);

// Let's initialize a collider that biases to 16-bit seeds
$collider = new Collision32Bit();

// Let's ask for 16384 distinct keypairs
$keypairs = $collider->createDistinctKeyPairs(16384);

$saveBoth = [];
$savePublic = [];

foreach ($keypairs as $keypair) {
    $saveBoth []= [
        'secret' => sodium_bin2hex($keypair[0]),
        'public' => sodium_bin2hex($keypair[1])
    ];
    $savePublic []= sodium_bin2hex($keypair[1]);
}

file_put_contents(
    __DIR__ . '/key-pairs.json',
    json_encode($saveBoth, JSON_PRETTY_PRINT, JSON_UNESCAPED_SLASHES)
);


file_put_contents(
    __DIR__ . '/public-keys.json',
    json_encode($savePublic, JSON_PRETTY_PRINT, JSON_UNESCAPED_SLASHES)
);
